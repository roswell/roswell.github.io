<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width,initial-scale=1">
		<title>Roswell - Common Lisp environment setup Utility.</title>
		<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css" integrity="sha384-/Y6pD6FV/Vv2HJnA6t+vslU6fwYXjCFtcEpHbNJ0lyAFsXTsjBbfaDjzALeQsN6M" crossorigin="anonymous">
		<link href="https://fonts.googleapis.com/css?family=Orbitron:700" rel="stylesheet">
		<style>
html, body {
	height: 100%;
}
main {
	margin-top: 100px;
}
footer {
	background:#f6f6f6;
	height: 100px;
	padding: 10px;
}
#title {
	margin-bottom: 30px;
}
.navbar-brand {
	font-family: 'Orbitron', sans-serif;
}
.dropdown-item:hover, .dropdown-item:focus{
	background-color: transparent;
}
		</style>
	</head>
	<body>
		<header>
			<nav class="navbar fixed-top navbar-expanded-xl navbar-dark bg-success">
				<a class="navbar-brand" href=".">
					roswell
				</a>
				<div class="navbar-nav mr-auto">
					<a class="nav-item nav-link text-light github" href="https://github.com/roswell/roswell">
						Contribute in
						<i class="fa fa-github" aria-hidden="true"></i>
					</a>
				</div>
				<button class="navbar-toggler d-xs-block d-sm-block d-md-none" type="button" data-toggle="collapse" data-target="#menu" aria-controls="menu" aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>
				<div class="collapse navbar-collapse" id="menu">
					<ul class="navbar-nav">
						
							<li class="nav-item dropdown">
								<a id="Home" class="nav-link dropdown-toggle text-light" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expand="false">
									Home
								</a>
								<div class="dropdown-menu bg-success" aria-labelledby="Home">
									
										<a class="dropdown-item text-light" href="Home.html">
											Home
										</a>
									
										<a class="dropdown-item text-light" href="How-is-Roswell-different.html">
											How is Roswell different
										</a>
									
								</div>
							</li>
						
							<li class="nav-item dropdown">
								<a id="Getting started" class="nav-link dropdown-toggle text-light" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expand="false">
									Getting started
								</a>
								<div class="dropdown-menu bg-success" aria-labelledby="Getting started">
									
										<a class="dropdown-item text-light" href="Installation.html">
											Installation
										</a>
									
										<a class="dropdown-item text-light" href="Initial-Recommended-Setup.html">
											Initial Recommended Setup
										</a>
									
										<a class="dropdown-item text-light" href="Upgrading-Roswell.html">
											Upgrading Roswell
										</a>
									
										<a class="dropdown-item text-light" href="Local-installation.html">
											Local installation
										</a>
									
										<a class="dropdown-item text-light" href="How-to-setup-a-lisp-dev-environment-on-windows-with-Roswell..html">
											How to setup a lisp dev environment on windows with Roswell.
										</a>
									
								</div>
							</li>
						
							<li class="nav-item dropdown">
								<a id="Roswell as a scripting environment" class="nav-link dropdown-toggle text-light" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expand="false">
									Roswell as a scripting environment
								</a>
								<div class="dropdown-menu bg-success" aria-labelledby="Roswell as a scripting environment">
									
										<a class="dropdown-item text-light" href="Roswell-as-a-Scripting-Environment.html">
											Roswell as a Scripting Environment
										</a>
									
										<a class="dropdown-item text-light" href="Advanced-scripting.html">
											Advanced scripting
										</a>
									
										<a class="dropdown-item text-light" href="Reducing-Startup-Time.html">
											Reducing Startup Time
										</a>
									
										<a class="dropdown-item text-light" href="List-of-Roswell-Installable-Scripts.html">
											List of Roswell Installable Scripts
										</a>
									
										<a class="dropdown-item text-light" href="Practical-Usecases.html">
											Practical Usecases
										</a>
									
								</div>
							</li>
						
							<li class="nav-item dropdown">
								<a id="Roswell as an implementation manager" class="nav-link dropdown-toggle text-light" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expand="false">
									Roswell as an implementation manager
								</a>
								<div class="dropdown-menu bg-success" aria-labelledby="Roswell as an implementation manager">
									
										<a class="dropdown-item text-light" href="Roswell-as-an-implementation-manager.html">
											Roswell as an implementation manager
										</a>
									
										<a class="dropdown-item text-light" href="Listing-various-resources.html">
											Listing various resources
										</a>
									
								</div>
							</li>
						
							<li class="nav-item dropdown">
								<a id="Roswell as a Testing Environment" class="nav-link dropdown-toggle text-light" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expand="false">
									Roswell as a Testing Environment
								</a>
								<div class="dropdown-menu bg-success" aria-labelledby="Roswell as a Testing Environment">
									
										<a class="dropdown-item text-light" href="Roswell-as-a-Testing-Environment.html">
											Roswell as a Testing Environment
										</a>
									
										<a class="dropdown-item text-light" href="Travis-CI.html">
											Travis CI
										</a>
									
										<a class="dropdown-item text-light" href="Circle-CI.html">
											Circle CI
										</a>
									
										<a class="dropdown-item text-light" href="Coveralls.html">
											Coveralls
										</a>
									
								</div>
							</li>
						
							<li class="nav-item dropdown">
								<a id="Distributing applications" class="nav-link dropdown-toggle text-light" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expand="false">
									Distributing applications
								</a>
								<div class="dropdown-menu bg-success" aria-labelledby="Distributing applications">
									
										<a class="dropdown-item text-light" href="How-to-distribute-your-software,-not-library,-on-Quicklisp-ala-python-pip.html">
											How to distribute your software, not library, on Quicklisp ala python pip
										</a>
									
								</div>
							</li>
						
							<li class="nav-item dropdown">
								<a id="FAQ" class="nav-link dropdown-toggle text-light" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expand="false">
									FAQ
								</a>
								<div class="dropdown-menu bg-success" aria-labelledby="FAQ">
									
										<a class="dropdown-item text-light" href="FAQ.html">
											FAQ
										</a>
									
								</div>
							</li>
						
					</ul>
				</div>
			</nav>
		</header>
		<main>
			<div class="container">
				<div class="row">
					<aside class="col-md-4 col-lg-3 d-none d-md-block d-lg-block d-xl-block">
						<ul class="">
							
								<li class="">
									Home
									<ul class="">
										
										<li>
											<a class="" href="Home.html">
												Home
											</a>
										</li>
										
										<li>
											<a class="" href="How-is-Roswell-different.html">
												How is Roswell different
											</a>
										</li>
										
									</ul>
								</li>
							
								<li class="">
									Getting started
									<ul class="">
										
										<li>
											<a class="" href="Installation.html">
												Installation
											</a>
										</li>
										
										<li>
											<a class="" href="Initial-Recommended-Setup.html">
												Initial Recommended Setup
											</a>
										</li>
										
										<li>
											<a class="" href="Upgrading-Roswell.html">
												Upgrading Roswell
											</a>
										</li>
										
										<li>
											<a class="" href="Local-installation.html">
												Local installation
											</a>
										</li>
										
										<li>
											<a class="" href="How-to-setup-a-lisp-dev-environment-on-windows-with-Roswell..html">
												How to setup a lisp dev environment on windows with Roswell.
											</a>
										</li>
										
									</ul>
								</li>
							
								<li class="">
									Roswell as a scripting environment
									<ul class="">
										
										<li>
											<a class="" href="Roswell-as-a-Scripting-Environment.html">
												Roswell as a Scripting Environment
											</a>
										</li>
										
										<li>
											<a class="" href="Advanced-scripting.html">
												Advanced scripting
											</a>
										</li>
										
										<li>
											<a class="" href="Reducing-Startup-Time.html">
												Reducing Startup Time
											</a>
										</li>
										
										<li>
											<a class="" href="List-of-Roswell-Installable-Scripts.html">
												List of Roswell Installable Scripts
											</a>
										</li>
										
										<li>
											<a class="" href="Practical-Usecases.html">
												Practical Usecases
											</a>
										</li>
										
									</ul>
								</li>
							
								<li class="">
									Roswell as an implementation manager
									<ul class="">
										
										<li>
											<a class="" href="Roswell-as-an-implementation-manager.html">
												Roswell as an implementation manager
											</a>
										</li>
										
										<li>
											<a class="" href="Listing-various-resources.html">
												Listing various resources
											</a>
										</li>
										
									</ul>
								</li>
							
								<li class="">
									Roswell as a Testing Environment
									<ul class="">
										
										<li>
											<a class="" href="Roswell-as-a-Testing-Environment.html">
												Roswell as a Testing Environment
											</a>
										</li>
										
										<li>
											<a class="" href="Travis-CI.html">
												Travis CI
											</a>
										</li>
										
										<li>
											<a class="" href="Circle-CI.html">
												Circle CI
											</a>
										</li>
										
										<li>
											<a class="" href="Coveralls.html">
												Coveralls
											</a>
										</li>
										
									</ul>
								</li>
							
								<li class="">
									Distributing applications
									<ul class="">
										
										<li>
											<a class="" href="How-to-distribute-your-software,-not-library,-on-Quicklisp-ala-python-pip.html">
												How to distribute your software, not library, on Quicklisp ala python pip
											</a>
										</li>
										
									</ul>
								</li>
							
								<li class="">
									FAQ
									<ul class="">
										
										<li>
											<a class="" href="FAQ.html">
												FAQ
											</a>
										</li>
										
									</ul>
								</li>
							
						</ul>
					</aside>
					<article class="col-md-8 col-lg-9">
						<h1 id="title">Travis CI</h1>
						<p>
<a href="https://travis-ci.org/">Travis CI</a> is currently known as the most prevalent cloud CI service. Although it does not have an official support for Common Lisp, <a href="https://github.com/roswell/roswell">Roswell</a> almost eliminates the otherwise huge amount of effort for testing your Common Lisp product.
</p>
<p>
Disclaimer: This document is based on Roswell v0.0.3.44 or above, so the content might change in the near future. Check the time stamp of this article and if it seems obsoleted --- contact us (or make it up to date yourself!!!).
</p>
<p>
Before getting started, sign up to Travis CI and enable the testing for your repository at <a href="https://travis-ci.org/profile">your profile page</a>.
</p>

<h2>Basic .travis.yml</h2>

<p>
Travis CI's build process can be customized with a file named <code>.travis.yml</code>, which Travis assumes to be located at the project root. (cf. <a href="http://docs.travis-ci.com/user/customizing-the-build/">Customizing the Build - Travis CI</a>) Below is a simple <code>.travis.yml</code> example which runs the unit test for <a href="https://github.com/fukamachi/quri">quri</a>, an improved/faster replacement for PURI URI encoder/decoder, with the latest SBCL binary:
</p>
<p>
<code></code>`yaml
language: common-lisp
sudo: required
</p>
<p>
install:
</p>
<ul>
<li>
curl -L https://raw.githubusercontent.com/roswell/roswell/release/scripts/install-for-ci.sh | sh
</li>
</ul>

<p>
script:
</p>
<ul>
<li>
ros -s prove -e '(or (prove:run :quri-test) (uiop:quit -1))' <code></code>`
</li>
</ul>

<p>
This basic template is fully functional. However, in order to use the latest and complete testing environment, you should add several options to the yaml file.
</p>

<h2>Advanced .travis.yml</h2>

<p>
Fast forward, the resulting script is shown below. You can use this as a template.
</p>
<p>
<code></code>`yaml
language: common-lisp
sudo: false
</p>
<p>
addons:
  apt:
    packages:
</p>
<ul>
<li>
libc6-i386
</li>
<li>
openjdk-7-jre
</li>
</ul>

<p>
env:
  global:
</p>
<ul>
<li>
PATH=~/.roswell/bin:$PATH
</li>
<li>
ROSWELL<em>INSTALL</em>DIR=$HOME/.roswell matrix:
</li>
<li>
LISP=sbcl-bin
</li>
<li>
LISP=ccl-bin
</li>
<li>
LISP=abcl
</li>
<li>
LISP=clisp
</li>
<li>
LISP=ecl
</li>
<li>
LISP=cmucl
</li>
<li>
LISP=alisp
</li>
</ul>

<p>
matrix:
  allow_failures:
</p>
<ul>
<li>
env: LISP=clisp
</li>
<li>
env: LISP=abcl
</li>
<li>
env: LISP=ecl
</li>
<li>
env: LISP=cmucl
</li>
<li>
env: LISP=alisp
</li>
</ul>

<p>
install:
</p>
<ul>
<li>
curl -L https://raw.githubusercontent.com/roswell/roswell/release/scripts/install-for-ci.sh | sh
</li>
<li>
ros install prove
</li>
<li>
ros install fukamachi/fast-http
</li>
<li>
ros install fukamachi/quri
</li>
</ul>

<p>
cache:
  directories:
</p>
<ul>
<li>
$HOME/.roswell
</li>
<li>
$HOME/.config/common-lisp
</li>
</ul>

<p>
script:
</p>
<ul>
<li>
run-prove quri-test.asd <code></code>`
</li>
</ul>


<h1>Step by Step Instruction</h1>

<p>
## Tests with multiple implementations
</p>
<p>
The foremost important feature in automated continuous testing is to run the tests on multiple implementations.
<code>env.matrix</code> in .travis.yml enables this feature, and Travis creates a new build for each Lisp implementations.
When <code>$LISP</code> is set, Roswell's CI installer sets up the corresponding Lisp implementation, so no need to installing and running each implementation manually.
</p>
<p>
<code></code>`diff
language: common-lisp
sudo: required
</p>

<ol>
<li>
env:
</li>
</ol>
<ul>
<li>
matrix:
</li>
<li>
<ul>
<li>
LISP=sbcl-bin
</li>
</ul>
</li>
<li>
<ul>
<li>
LISP=ccl-bin
</li>
</ul>
</li>
<li>
<ul>
<li>
LISP=abcl
</li>
</ul>
</li>
<li>
<ul>
<li>
LISP=clisp
</li>
</ul>
</li>
<li>
<ul>
<li>
LISP=ecl
</li>
</ul>
</li>
</ul>

<p>
...
<code></code>`
</p>

<h2>Ignore the failures on some implementations</h2>

<p>
You might think that the tests on some implementations are less important than on the others.
In that case, add <code>matrix.allow_failures</code> directive.
cf. <a href="http://docs.travis-ci.com/user/customizing-the-build/#Rows-that-are-Allowed-to-Fail">Rows that are Allowed to Fail - Travis CI</a>
</p>
<p>
<code></code>`diff
env:
  matrix:
</p>
<ul>
<li>
LISP=sbcl-bin
</li>
<li>
LISP=ccl-bin
</li>
<li>
LISP=abcl
</li>
<li>
LISP=clisp
</li>
<li>
LISP=ecl
</li>
</ul>


<ol>
<li>
matrix:
</li>
</ol>
<ul>
<li>
allow_failures:
</li>
<li>
<ul>
<li>
env: LISP=clisp <code></code>`
</li>
</ul>
</li>
</ul>


<h2>Installing the latest dependencies</h2>

<p>
You may wonder how you can run the test using a latest version of a library which is not yet included in the quicklisp.
Libraries at GitHub can be installed with <code>ros install &lt;github username&gt;/&lt;github repos&gt;</code> like this:
</p>
<p>
<code>`diff
install:
</p>
&lt;ul&gt;
&lt;li&gt;
curl -L https://raw.githubusercontent.com/roswell/roswell/release/scripts/install-for-ci.sh | sh
&lt;ul&gt;
&lt;li&gt;
# Using the latest fast-http and quri
&lt;/li&gt;
&lt;li&gt;
&lt;ul&gt;
&lt;li&gt;
ros install fukamachi/fast-http
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;ul&gt;
&lt;li&gt;
ros install fukamachi/quri </code>`
</li>
</ul>
</li>
</ul>
</li>
</ul>


<h2>Activating the container-based infrastructure</h2>

<p>
When <code>sudo</code> field is set to <code>false</code> in the yaml configuration, i.e. <code>sudo: false</code>, Travis CI uses its new <a href="http://docs.travis-ci.com/user/workers/container-based-infrastructure/">container-based infrastructure</a>. We can expect faster launch time of the tests compared to the old infrastructure.
</p>
<p>
For <code>sbcl</code> and <code>ccl</code>, following <code>.travis.yml</code> just works.
</p>
<p>
<code></code>`diff
language: common-lisp
</p>
<ul>
<li>
sudo: required
</li>
</ul>
<ol>
<li>
sudo: false
</li>
</ol>

<p>
env:
  global:
</p>
<ul>
<li>
PATH=~/.roswell/bin:$PATH
<ul>
<li>
<ul>
<li>
ROSWELL<em>INSTALL</em>DIR=$HOME/.roswell matrix:
</li>
</ul>
</li>
</ul>
</li>
<li>
LISP=sbcl-bin
</li>
<li>
LISP=ccl-bin
</li>
</ul>

<p>
install:
</p>
<ul>
<li>
curl -L https://raw.githubusercontent.com/roswell/roswell/release/scripts/install-for-ci.sh | sh
</li>
</ul>

<p>
script:
</p>
<ul>
<li>
ros -s prove -e '(or (prove:run :quri-test) (uiop:quit -1))' <code></code>`
</li>
</ul>

<p>
To use the new infrastructure for <code>clisp</code>, <code>abcl</code>, <code>alisp</code> or <code>cmucl</code>, add the following lines to the yaml file:
</p>
<p>
<code>`yaml
addons:
  apt:
    packages:
</p>
&lt;ul&gt;
&lt;li&gt;
libc6-i386
&lt;/li&gt;
&lt;li&gt;
openjdk-7-jre </code>`
</li>
</ul>

<p>
This is because <code>clisp</code>, <code>abcl</code>, <code>alisp</code> or <code>cmucl</code> requies <code>openjdk-7-jre</code>, <code>clisp</code> and <code>libc-i386</code> to be installed via APT, respectively.
</p>

<h2>Directory caching</h2>

<p>
Directory caching makes the launch time even faster.
cf. <a href="http://docs.travis-ci.com/user/caching/">Caching Dependencies and Directories - Travis CI</a>
</p>
<p>
<code></code>`diff
language: common-lisp
sudo: false
</p>
<p>
env:
  global:
</p>
<ul>
<li>
PATH=~/.roswell/bin:$PATH
</li>
<li>
ROSWELL<em>INSTALL</em>DIR=$HOME/.roswell matrix:
</li>
<li>
LISP=sbcl-bin
</li>
<li>
LISP=ccl-bin
</li>
</ul>

<p>
install:
</p>
<ul>
<li>
curl -L https://raw.githubusercontent.com/roswell/roswell/release/scripts/install-for-ci.sh | sh
</li>
</ul>


<ol>
<li>
cache:
</li>
</ol>
<ul>
<li>
directories:
</li>
<li>
<ul>
<li>
$HOME/.roswell
</li>
</ul>
</li>
<li>
<ul>
<li>
$HOME/.config/common-lisp
</li>
</ul>
</li>
</ul>

<p>
script:
</p>
<ul>
<li>
ros -s prove -e '(or (prove:run :quri-test) (uiop:quit -1))' <code></code>`
</li>
</ul>


<h2>Using Roswell script (run-prove)</h2>

<p>
Some libraries provide their Roswell scripts, like <a href="https://github.com/fukamachi/prove">prove</a>'s <code>run-prove</code> command. Install these commands via e.g. <code>ros install prove</code>. Make sure <code>~/.roswell/bin</code> is already in the <code>$PATH</code>.
</p>
<p>
<code></code>`diff
language: common-lisp
sudo: required
</p>
<p>
env:
  global:
</p>
<ul>
<li>
PATH=~/.roswell/bin:$PATH       # !!! IMPORTANT !!! matrix:
</li>
<li>
LISP=sbcl-bin
</li>
<li>
LISP=ccl-bin
</li>
<li>
LISP=abcl
</li>
<li>
LISP=clisp
</li>
<li>
LISP=ecl
</li>
</ul>

<p>
matrix:
  allow_failures:
</p>
<ul>
<li>
env: LISP=clisp
</li>
</ul>

<p>
install:
</p>
<ul>
<li>
curl -L https://raw.githubusercontent.com/roswell/roswell/release/scripts/install-for-ci.sh | sh
<ul>
<li>
<ul>
<li>
ros install prove
</li>
</ul>
</li>
</ul>
</li>
</ul>

<p>
script:
</p>
<ul>
<li>
<ul>
<li>
ros -s prove -e '(or (prove:run :quri-test) (uiop:quit -1))'
</li>
</ul>
</li>
<li>
<ul>
<li>
run-prove quri-test.asd <code></code>`
</li>
</ul>
</li>
</ul>

					</article>
				</div>
			</div>
		</main>
		<footer>
			<div class="container text-center">
				<p>
					<a href="https://github.com/roswell/roswell">Roswell</a> /
					<a href="https://github.com/roswell/roswell/blob/master/COPYING">Distributed under MIT License</a> /
					<a href="https://github.com/roswell/roswell/blob/master/README.md#author">Author</a>
				</p>
				<p>
				Found an issue with the docs? Report it <a href="https://github.com/roswell/roswell/issues">here</a>.
				</p>
			</div>
		</footer>
		<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4" crossorigin="anonymous"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/js/bootstrap.min.js" integrity="sha384-h0AbiXch4ZDo7tp9hKZ4TsHbi047NrKGLO3SEJAg45jXxnGIfYzk4Si90RDIqNm1" crossorigin="anonymous"></script>
	</body>
</html>
